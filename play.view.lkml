view: play {
  derived_table: {
    sql:select *, case when video_id in (select 231517 as video_id union all
select 245040 as video_id union all
select 231501 as video_id union all
select 231516 as video_id union all
select 240165 as video_id union all
select 231518 as video_id union all
select 245039 as video_id union all
select 214136 as video_id union all
select 209367 as video_id union all
select 209368 as video_id union all
select 209371 as video_id union all
select 212529 as video_id union all
select 214137 as video_id union all
select 212512 as video_id union all
select 214138 as video_id union all
select 209287 as video_id union all
select 209370 as video_id union all
select 212502 as video_id union all
select 212503 as video_id union all
select 212504 as video_id union all
select 224418 as video_id union all
select 212505 as video_id union all
select 212507 as video_id union all
select 212508 as video_id union all
select 209372 as video_id union all
select 209303 as video_id union all
select 209308 as video_id union all
select 213577 as video_id union all
select 213578 as video_id union all
select 209328 as video_id union all
select 209045 as video_id union all
select 209279 as video_id union all
select 212515 as video_id union all
select 209309 as video_id union all
select 214131 as video_id union all
select 212505 as video_id union all
select 209312 as video_id union all
select 209313 as video_id union all
select 209316 as video_id union all
select 209034 as video_id union all
select 209281 as video_id union all
select 209039 as video_id union all
select 209320 as video_id union all
select 212520 as video_id union all
select 209288 as video_id union all
select 209277 as video_id union all
select 212524 as video_id union all
select 208872 as video_id union all
select 209300 as video_id union all
select 208877 as video_id union all
select 209291 as video_id union all
select 208881 as video_id union all
select 209284 as video_id union all
select 209292 as video_id union all
select 209293 as video_id union all
select 209295 as video_id union all
select 212498 as video_id union all
select 209311 as video_id union all
select 209321 as video_id union all
select 209283 as video_id union all
select 209285 as video_id union all
select 208900 as video_id union all
select 213505 as video_id union all
select 209305 as video_id union all
select 213581 as video_id union all
select 208879 as video_id union all
select 212513 as video_id union all
select 212527 as video_id union all
select 209315 as video_id union all
select 208869 as video_id union all
select 208873 as video_id union all
select 212499 as video_id union all
select 209040 as video_id union all
select 208875 as video_id union all
select 212501 as video_id union all
select 212506 as video_id union all
select 212519 as video_id union all
select 209374 as video_id union all
select 209049 as video_id union all
select 212495 as video_id union all
select 213503 as video_id union all
select 209042 as video_id union all
select 213501 as video_id union all
select 208883 as video_id union all
select 209038 as video_id union all
select 213516 as video_id union all
select 209051 as video_id union all
select 212516 as video_id union all
select 224081 as video_id union all
select 240167 as video_id union all
select 224080 as video_id union all
select 240168 as video_id union all
select 245041 as video_id union all
select 231519 as video_id union all
select 254077 as video_id union all
select 240166 as video_id union all
select 254078 as video_id union all
select 214133 as video_id union all
select 214134 as video_id union all
select 224079 as video_id union all
select 245038 as video_id union all
select 209369 as video_id union all
select 212526 as video_id union all
select 209286 as video_id union all
select 214139 as video_id union all
select 209033 as video_id union all
select 209037 as video_id union all
select 209324 as video_id union all
select 209325 as video_id union all
select 209375 as video_id union all
select 209326 as video_id union all
select 209378 as video_id union all
select 214140 as video_id union all
select 209327 as video_id union all
select 212517 as video_id union all
select 209329 as video_id union all
select 212518 as video_id union all
select 208867 as video_id union all
select 208868 as video_id union all
select 212528 as video_id union all
select 209310 as video_id union all
select 209314 as video_id union all
select 209035 as video_id union all
select 209318 as video_id union all
select 208884 as video_id union all
select 209319 as video_id union all
select 209276 as video_id union all
select 209278 as video_id union all
select 209041 as video_id union all
select 209322 as video_id union all
select 209323 as video_id union all
select 214135 as video_id union all
select 209289 as video_id union all
select 209280 as video_id union all
select 208871 as video_id union all
select 209298 as video_id union all
select 212525 as video_id union all
select 209376 as video_id union all
select 212521 as video_id union all
select 209301 as video_id union all
select 212522 as video_id union all
select 208876 as video_id union all
select 212523 as video_id union all
select 208880 as video_id union all
select 209290 as video_id union all
select 208882 as video_id union all
select 209294 as video_id union all
select 212497 as video_id union all
select 209296 as video_id union all
select 209297 as video_id union all
select 209299 as video_id union all
select 209302 as video_id union all
select 212500 as video_id union all
select 209307 as video_id union all
select 209282 as video_id union all
select 209377 as video_id union all
select 208878 as video_id union all
select 213515 as video_id union all
select 209304 as video_id union all
select 209306 as video_id union all
select 213539 as video_id union all
select 209373 as video_id union all
select 212511 as video_id union all
select 212494 as video_id union all
select 209317 as video_id union all
select 212514 as video_id union all
select 209043 as video_id union all
select 208874 as video_id union all
select 212510 as video_id union all
select 208870 as video_id union all
select 209044 as video_id union all
select 209046 as video_id union all
select 212509 as video_id union all
select 209047 as video_id union all
select 209048 as video_id union all
select 209050 as video_id union all
select 212496 as video_id) then 1 else 0 end as watched_heartland
from ios.play;;
  }

  dimension: watched_heartland {
    type: number
    sql: ${TABLE}.watched_heartland ;;
  }

  measure: watched_heartland_total {
    type: sum
    sql: ${watched_heartland} ;;
  }

  dimension: id {
    primary_key: yes
    type: string
    sql: ${TABLE}.id ;;
  }

  dimension: anonymous_id {
    type: string
    sql: ${TABLE}.anonymous_id ;;
  }

  dimension: context_app_build {
    type: string
    sql: ${TABLE}.context_app_build ;;
  }

  dimension: context_app_name {
    type: string
    sql: ${TABLE}.context_app_name ;;
  }

  dimension: context_app_namespace {
    type: string
    sql: ${TABLE}.context_app_namespace ;;
  }

  dimension: context_app_version {
    type: string
    sql: ${TABLE}.context_app_version ;;
  }

  dimension: context_device_ad_tracking_enabled {
    type: yesno
    sql: ${TABLE}.context_device_ad_tracking_enabled ;;
  }

  dimension: context_device_advertising_id {
    type: string
    sql: ${TABLE}.context_device_advertising_id ;;
  }

  dimension: context_device_id {
    type: string
    sql: ${TABLE}.context_device_id ;;
  }

  dimension: context_device_manufacturer {
    type: string
    sql: ${TABLE}.context_device_manufacturer ;;
  }

  dimension: context_device_model {
    type: string
    sql: ${TABLE}.context_device_model ;;
  }

  dimension: context_device_token {
    type: string
    sql: ${TABLE}.context_device_token ;;
  }

  dimension: context_device_type {
    type: string
    sql: ${TABLE}.context_device_type ;;
  }

  dimension: context_ip {
    type: string
    sql: ${TABLE}.context_ip ;;
  }

  dimension: context_library_name {
    type: string
    sql: ${TABLE}.context_library_name ;;
  }

  dimension: context_library_version {
    type: string
    sql: ${TABLE}.context_library_version ;;
  }

  dimension: context_locale {
    type: string
    sql: ${TABLE}.context_locale ;;
  }

  dimension: context_network_carrier {
    type: string
    sql: ${TABLE}.context_network_carrier ;;
  }

  dimension: context_network_cellular {
    type: yesno
    sql: ${TABLE}.context_network_cellular ;;
  }

  dimension: context_network_wifi {
    type: yesno
    sql: ${TABLE}.context_network_wifi ;;
  }

  dimension: context_os_name {
    type: string
    sql: ${TABLE}.context_os_name ;;
  }

  dimension: context_os_version {
    type: string
    sql: ${TABLE}.context_os_version ;;
  }

  dimension: context_screen_height {
    type: number
    sql: ${TABLE}.context_screen_height ;;
  }

  dimension: context_screen_width {
    type: number
    sql: ${TABLE}.context_screen_width ;;
  }

  dimension: context_timezone {
    type: string
    sql: ${TABLE}.context_timezone ;;
  }

  dimension: current_src {
    type: string
    sql: ${TABLE}.current_src ;;
  }

  dimension: current_subtitle {
    type: string
    sql: ${TABLE}.current_subtitle ;;
  }

  dimension: current_type {
    type: string
    sql: ${TABLE}.current_type ;;
  }

  dimension: device_id {
    type: string
    sql: ${TABLE}.device_id ;;
  }

  dimension: duration {
    type: number
    sql: ${TABLE}.duration ;;
  }

  dimension: event {
    type: string
    sql: ${TABLE}.event ;;
  }

  dimension: event_text {
    type: string
    sql: ${TABLE}.event_text ;;
  }

  dimension: is_airplay {
    type: yesno
    sql: ${TABLE}.is_airplay ;;
  }

  dimension: is_chromecast {
    type: yesno
    sql: ${TABLE}.is_chromecast ;;
  }

  dimension: is_drm {
    type: yesno
    sql: ${TABLE}.is_drm ;;
  }

  dimension: is_fullscreen {
    type: yesno
    sql: ${TABLE}.is_fullscreen ;;
  }

  dimension: is_trailer {
    type: yesno
    sql: ${TABLE}.is_trailer ;;
  }

  dimension: name {
    type: string
    sql: ${TABLE}.name ;;
  }

  dimension_group: original_timestamp {
    type: time
    timeframes: [
      raw,
      time,
      date,
      week,
      month,
      quarter,
      year
    ]
    sql: ${TABLE}.original_timestamp ;;
  }

  dimension: platform {
    type: string
    sql: ${TABLE}.platform ;;
  }

  dimension: platform_id {
    type: string
    sql: ${TABLE}.platform_id ;;
  }

  dimension: platform_version {
    type: string
    sql: ${TABLE}.platform_version ;;
  }

  dimension_group: received {
    type: time
    timeframes: [
      raw,
      time,
      date,
      week,
      month,
      quarter,
      year
    ]
    sql: ${TABLE}.received_at ;;
  }

  dimension: seconds {
    type: number
    sql: ${TABLE}.seconds ;;
  }

  dimension_group: sent {
    type: time
    timeframes: [
      raw,
      time,
      date,
      week,
      month,
      quarter,
      year
    ]
    sql: ${TABLE}.sent_at ;;
  }

  dimension: session_id {
    type: string
    sql: ${TABLE}.session_id ;;
  }

  dimension: timecode {
    type: number
    sql: ${TABLE}.timecode ;;
  }

  dimension_group: timestamp {
    type: time
    timeframes: [
      raw,
      time,
      date,
      week,
      month,
      quarter,
      year
    ]
    sql: ${TABLE}.timestamp ;;
  }

  dimension: type {
    type: string
    sql: ${TABLE}.type ;;
  }

  dimension: user_id {
    type: string
    tags: ["user_id"]
    # hidden: yes
    sql: ${TABLE}.user_id ;;
  }

  measure: average_number_of_plays_per_user {
    type:  average
    sql:  count(${user_id}) ;;
  }

  dimension: useremail {
    type: string
    tags: ["email"]
    sql: ${TABLE}.useremail ;;
  }

  dimension: username {
    type: string
    sql: ${TABLE}.username ;;
  }

  dimension: uuid {
    type: number
    value_format_name: id
    sql: ${TABLE}.uuid ;;
  }

  dimension_group: uuid_ts {
    type: time
    timeframes: [
      raw,
      time,
      date,
      week,
      month,
      quarter,
      year
    ]
    sql: ${TABLE}.uuid_ts ;;
  }

  dimension: video_id {
    type: string
    sql: ${TABLE}.video_id ;;
  }

  measure: count {
    type: count
    drill_fields: [detail*]
  }

  # ----- Sets of fields for drilling ------
  set: detail {
    fields: [
      id,
      name,
      context_library_name,
      context_app_name,
      context_os_name,
      username,
      users.context_os_name,
      users.context_library_name,
      users.context_app_name,
      users.id
    ]
  }
}
